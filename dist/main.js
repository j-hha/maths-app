(()=>{"use strict";const e=(e,t)=>(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)),t=class{constructor(e,t,s){this.data=this.getLesson(e,t,s)}generateLessonData(t=0,s="1"){const n=[],r=parseInt(s,10);if("number"==typeof r&&!isNaN(r)){for(let e=0;e<=t;e++)n.push({factor1:e,factor2:s});return n}for(let s=0;s<=t;s++)n.push({factor1:e(0,10),factor2:e(0,10)});return n}orderLessonData(e,t){switch(t){case"regular":return e;case"reverse":return e.reverse();case"random":return(e=>{for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e})(e);default:throw new Error("Unknown lesson mode.")}}getLesson(e=0,t="1",s="regular"){const n=this.generateLessonData(e,t);try{return this.orderLessonData(n,s)}catch(e){return console.log(e.message),n}}},s=class{constructor(e){this.progress={exerciseIndex:0,correctAnswers:0,incorrectAnswers:0},this.lessonData=e,this.numOfLessons=e.length,this.handleSubmit=this.handleSubmit.bind(this),this.handleChange=this.handleChange.bind(this),this.checkAnswer=this.checkAnswer.bind(this),this.next=this.next.bind(this),this.newLesson=this.newLesson.bind(this),this.elements={form:document.getElementById("js-form"),input:document.getElementById("js-input"),response:document.getElementById("js-response"),factor1:document.getElementById("js-factor-1"),factor2:document.getElementById("js-factor-2"),next:document.getElementById("js-next"),submit:document.getElementById("js-submit"),newSession:document.getElementById("js-new"),home:document.getElementById("js-home"),mainNav:document.getElementById("js-main-nav"),main:document.getElementById("main")}}updateProgress(e){this.progress={...this.progress,...e}}generateExercise(){const{factor1:e,factor2:t}=this.elements,{exerciseIndex:s}=this.progress;e.innerHTML=this.lessonData[s].factor1,t.innerHTML=this.lessonData[s].factor2}newLesson(){const{main:e,mainNav:t}=this.elements;this.resetResponse(),this.resetAnswer(),e.innerHTML="",t.classList.remove("main-nav--visible"),n()}init(){const{form:e,input:t,next:s,newSession:n,home:r,mainNav:i}=this.elements;this.generateExercise(),e.addEventListener("submit",this.handleSubmit),t.addEventListener("change",this.handleChange),s.addEventListener("click",this.next),n.addEventListener("click",this.newLesson),i.classList.add("main-nav--visible"),r.addEventListener("click",this.newLesson)}next(){this.generateExercise(),this.resetResponse(),this.resetAnswer(),this.updateView(!1,!1,"next")}checkAnswer(e){const{next:t,input:s,submit:n,form:r}=this.elements,{exerciseIndex:i,correctAnswers:o,incorrectAnswers:a}=this.progress,c=this.lessonData[i].factor1*this.lessonData[i].factor2,l=0!==parseInt(e)?e.replace(/^0+/,""):e.replace(/^0+/,"0");if(c!==parseInt(e))throw this.updateProgress({incorrectAnswers:a+1}),new Error("Rechne bitte noch mal nach. Dieses Ergebnis stimmt leider nicht.");i===this.numOfLessons-1?(this.updateView(!0,!0,"new"),this.showResponse(`Super! ${l} ist korrekt! Du hast alle Aufgaben gelÃ¶st.`)):(this.updateView(!0,!0,"next"),this.showResponse(`Super! ${l} ist korrekt! Weiter so!`)),this.updateProgress({exerciseIndex:i+1,correctAnswers:o+1})}updateView(e=!1,t=!1,s=""){const{next:n,input:r,submit:i,form:o,newSession:a}=this.elements;if(r.disabled=e,i.disabled=e,o.disabled=e,"string"!=typeof s||0===s.length)return;let c=null;switch(s){case"next":c=n;break;case"new":c=a;break;default:c=null}c&&(t?c.classList.add(`button__${s}--visible`):c.classList.remove(`button__${s}--visible`))}validateForm(e){if(!e||isNaN(parseInt(e)))throw new Error("Bitte gib eine Zahl ein.");this.checkAnswer(e)}showResponse(e){const{response:t}=this.elements;t.innerHTML=e}setErrors(e){const{input:t}=this.elements;t.classList.add("input--error"),this.showResponse(e)}resetError(){const{input:e}=this.elements;e.classList.remove("input--error")}resetResponse(){this.showResponse("")}resetAnswer(){const{input:e}=this.elements;e.value=""}handleChange(){this.resetResponse()}handleSubmit(e){const{input:{value:t}}=this.elements;this.resetResponse(),e.preventDefault();try{this.validateForm(t)}catch(e){this.setErrors(e.message)}}},n=()=>{const e=document.getElementById("main"),n=document.querySelector("#lesson-select"),r=(n,r)=>{e.innerHTML="",(()=>{const e=document.getElementById("main"),t=document.querySelector("#lesson-card").content.cloneNode(!0);e.appendChild(t)})();const i=new t(10,n,r);new s(i.data).init()};for(let t=0;t<=10;t++){const s=n.content.cloneNode(!0),i=s.querySelector(".lesson-select__title"),o=t.toString();i.textContent=o,s.querySelectorAll(".lesson-select__button").forEach((e=>{e.addEventListener("click",(()=>{r(o,e.dataset.mode)}))})),e.appendChild(s)}const i=document.querySelector("#lesson-select--random").content.cloneNode(!0),o=i.querySelector(".lesson-select__title"),a=i.querySelector("button");o.textContent="Zufall",a.addEventListener("click",(()=>{r("Start","random")})),e.appendChild(i)};n()})();